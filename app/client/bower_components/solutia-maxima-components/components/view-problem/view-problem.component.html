<link rel="import" href="../../../polymer/polymer.html">

<link rel="import" href="../../../iron-autogrow-textarea/iron-autogrow-textarea.html">
<link rel="import" href="../../../paper-spinner/paper-spinner.html">
<link rel="import" href="../../../paper-button/paper-button.html">
<link rel="import" href="../../../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../../iron-ajax/iron-ajax.html">
<link rel="import" href="../../../paper-toast/paper-toast.html">
<link rel="import" href="../../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../../paper-listbox/paper-listbox.html">
<link rel="import" href="../../../paper-item/paper-item.html">
<link rel="import" href="../render-math/render-math.component.html">

<dom-module id="solutia-maxima-view-problem">
    <template>
        <iron-ajax id="getProblemAjax" url="http://localhost:5000/api/question/[[questionId]]/[[quizSessionId]]/[[jwt]]" method="get" handle-as="json"></iron-ajax>
        <iron-ajax id="checkAnswerAjax" url="http://localhost:5000/api/checkanswer" method="post" content-type="application/json" handle-as="json"></iron-ajax>
        <paper-toast id="toast" text="[[toastMessage]]"></paper-toast>

        <div class="flex-row flex-center problem-container">
            <div class="flex-col flex-center">
                <paper-spinner active hidden="[[!hideRenderMath]]"></paper-spinner>
                <solutia-maxima-render-math hidden="[[hideRenderMath]]" text="[[problemText]]" on-renderingbegun="mathRenderingBegun" on-renderingcomplete="mathRenderingComplete"></solutia-maxima-render-math>

                <template is="dom-if" if="[[!concise]]">
                    <div class="flex-col">
                        <iron-autogrow-textarea id="answerInput" type="text" placeholder="type answer" class="answer-input" hidden="[[computeAnswerInputHidden(userInputs, userCheckboxes, userRadios)]]" on-input="answerTyped"></iron-autogrow-textarea>

                        <div class="flex-row">
                            <template is="dom-if" if="[[answer]]">
                                <paper-button class="check-answer-button" on-tap="showAnswer" raised>Answer</paper-button>
                            </template>

                            <template is="dom-if" if="[[hint]]">
                                <paper-button class="check-answer-button" on-tap="showHint" raised>Hint</paper-button>
                            </template>

                            <template is="dom-if" if="[[showCheckAnswer]]">
                                <paper-button class="check-answer-button" on-tap="checkAnswer" raised>Check</paper-button>
                            </template>
                        </div>

                        <div class="flex-row">
                            <template is="dom-if" if="[[showConfidenceLevel]]">
                                <paper-dropdown-menu label="How confident are you?">
                                    <paper-listbox class="dropdown-content">
                                        <paper-item on-tap="verySureSelected">very sure</paper-item>
                                        <paper-item on-tap="prettySureSelected">pretty sure</paper-item>
                                        <paper-item on-tap="justGuessingSelected">just guessing</paper-item>
                                    </paper-listbox>
                                </paper-dropdown-menu>
                            </template>
                        </div>

                        <template is="dom-if" if="[[showQuestionGenerationButtons]]">
                            <div class="flex-row" style="margin-top: 25px;">
                                <paper-button on-tap="loadPrevProblem" raised>Prev</paper-button>
                                <paper-button on-tap="loadNextProblem" style="margin-left: auto" raised>Next</paper-button>
                            </div>
                        </template>
                    </div>
                </template>

            </div>
        </div>

        <style>
            .flex-row {
                display: flex;
                flex-direction: row;
            }

            .flex-wrap {
                flex-wrap: wrap;
            }

            .flex-col {
                display: flex;
                flex-direction: column;
            }

            .flex-center {
                justify-content: center;
                align-items: center;
            }

            .problem-container {
                margin-top: 10vh;
                margin-bottom: 10vh;
                margin-left: 5vw;
                margin-right: 5vw;
            }

            .problem-text {
                font-size: 25px;
                font-family: Ubuntu, sans-serif;
            }

            .answer-input {
                font-size: 25px;
                border: none !important;
                box-shadow: 0 2px 2px -2px grey;
                /*padding: 10px !important;
                font-size: 25px !important;
                border: none !important;
                border-top: 1px solid white;
                border-bottom: 1px solid grey !important;*/
            }

            .check-answer-button {
                margin-top: 10px;
                margin-left: auto;
            }
        </style>
    </template>

    <script>System.import('/bower_components/solutia-maxima-components/components/view-problem/view-problem.component.ts');</script>
</dom-module>
