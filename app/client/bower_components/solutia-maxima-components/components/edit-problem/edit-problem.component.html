<link rel="import" href="../../../polymer/polymer.html">

<link rel="import" href="../../../iron-icons/iron-icons.html">
<link rel="import" href="../../../iron-icons/notification-icons.html">
<link rel="import" href="../../../paper-fab/paper-fab.html">
<link rel="import" href="../../../iron-ajax/iron-ajax.html">
<link rel="import" href="../../../paper-dialog/paper-dialog.html">
<link rel="import" href="../../../paper-toast/paper-toast.html">
<link rel="import" href="../text-editor/text-editor.component.html">
<link rel="import" href="../code-editor/code-editor.component.html">
<link rel="import" href="../view-problem/view-problem.component.html">
<link rel="import" href="../../../redux-store-element/redux-store.html">

<dom-module id="solutia-maxima-edit-problem">
    <template>
        <redux-store root-reducer="[[rootReducer]]" on-statechange="mapStateToThis" action="[[action]]" store-name="EDIT_PROBLEM_COMPONENT"></redux-store>
        <paper-toast id="toast" text="[[toastMessage]]"></paper-toast>
        <iron-ajax id="getQuestionAjax" url="[[endpointDomain]]/api/question/[[questionId]]/DEFAULT_QUIZ/[[jwt]]" method="get" handle-as="json"></iron-ajax>

        <div style="display: flex; flex-direction: column">
            <div style="display: flex; flex-direction: row">
                <paper-fab id="previewFAB" icon="notification:personal-video" title="preview question" on-tap="previewQuestion" style="margin-left: auto; margin-bottom: -25px; margin-right: 10px; z-index: 6">Preview</paper-fab>
            </div>
            <solutia-maxima-text-editor id="textEditor" original-text="[[originalText]]"></solutia-maxima-text-editor>
            <solutia-maxima-code-editor id="codeEditor" original-code="[[originalCode]]" style="margin-top: 25px; box-shadow: 0px 0px 1px black"></solutia-maxima-code-editor>
            <div style="display: flex; flex-direction: row">
                <paper-fab id="saveFAB" icon="save" title="save question" on-tap="saveQuestion" style="margin-left: auto; margin-top: -25px; margin-right: 10px; z-index: 6">Save</paper-fab>
            </div>
        </div>

        <paper-dialog id="previewModal" with-backdrop="true">
            <solutia-maxima-view-problem id="viewPreviewQuestion" question-id="[[previewQuestionId]]" quiz-session-id="DEFAULT_QUIZ" jwt="[[jwt]]"></solutia-maxima-view-problem>
        </paper-dialog>

        <style>
            :host #saveFAB {
                --paper-fab-background: grey;
            }

            :host #previewFAB {
                --paper-fab-background: #3F83BF;
            }
        </style>
    </template>

    <script>System.import('/bower_components/solutia-maxima-components/components/edit-problem/edit-problem.component.ts');</script>
</dom-module>
