<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/redux-store-element/redux-store.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/solutia-maxima-components/components/view-problem/view-problem.component.html">
<link rel="import" href="../../bower_components/solutia-maxima-components/components/edit-problem/edit-problem.component.html">

<dom-module id="prendus-quiz-editor">
    <template>
        <redux-store on-statechange="mapStateToThis" action="[[action]]"></redux-store>
        <iron-ajax id="getQuestionIdsAjax" method="get" url="[[endpointDomain]]/api/questionids/uid/[[jwt]]" handle-as="json"></iron-ajax>

        <div style="display: flex; flex-direction: row">
            <div style="display: flex; flex-direction: column; flex: 1; box-shadow: 0px 0px 3px black; margin: 50px">
                <h1>Quiz</h1>
                <button on-click="showSettingsMenu">Quiz Settings</button>

                <template is="dom-if" if="[[showSettings]]">
                    <paper-toggle-button on-change="answerFeedbackToggled" checked="[[quizSettings.answerFeedback]]">Answer feedback</paper-toggle-button>
                    <paper-toggle-button on-change="showAnswerToggled" checked="[[quizSettings.showAnswer]]">Show answer</paper-toggle-button>
                    <paper-toggle-button on-change="showHintToggled" checked="[[quizSettings.showHint]]">Show hint</paper-toggle-button>
                    <paper-toggle-button on-change="showCodeToggled" checked="[[quizSettings.showCode]]">Show code</paper-toggle-button>
                    <paper-toggle-button on-change="gradedToggled" checked="[[quizSettings.graded]]">Graded</paper-toggle-button>
                    <paper-toggle-button on-change="showConfidenceLevelToggled" checked="[[quizSettings.showConfidenceLevel]]">Show confidence level</paper-toggle-button>
                    <paper-toggle-button on-change="allowGenerationToggled" checked="[[quizSettings.allowGeneration]]">Allow question generation</paper-toggle-button>
                    <paper-input label="Maximum number of attempts" value=[[quizSettings.maxNumAttempts]] on-change="maxNumAttemptsChanged"></paper-input>
                </template>

                <paper-input label="Title" on-change="titleChanged"></paper-input>

                <div id="quizDomRepeatContainer">
                    <template is="dom-repeat" items="[[quizQuestionIds]]">
                        <solutia-maxima-view-problem question-id="[[item]]" quiz-session-id="DEFAULT_QUIZ" jwt="[[jwt]]" concise></solutia-maxima-view-problem>
                        <div style="display: flex; flex-direction: row; align-items: center; justify-content: center">
                            <button on-click="removeQuestionFromQuiz">Remove</button>
                        </div>
                    </template>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; flex: 1; box-shadow: 0px 0px 3px black; margin: 50px">
                <h1>My Questions</h1>
                <button on-click="createQuestion">Create Question</button>
                <div id="myQuestionsDomRepeatContainer">
                    <template is="dom-repeat" items="[[userQuestionIds]]">
                        <solutia-maxima-view-problem question-id="[[item]]" quiz-session-id="DEFAULT_QUIZ" jwt="[[jwt]]" concise></solutia-maxima-view-problem>
                        <div style="display: flex; flex-direction: row; align-items: center; justify-content: center">
                            <button on-click="addQuestionToQuiz">Add to quiz</button>
                            <button on-click="editQuestion">Edit</button>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <script>System.import('/components/quiz-editor/quiz-editor.component.ts');</script>
</dom-module>
