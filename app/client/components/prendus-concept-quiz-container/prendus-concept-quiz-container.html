<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/redux-store-element/redux-store.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../../node_modules/prendus-services/styles/prendus-styles.html">

<dom-module id="prendus-concept-quiz-container">

  <template>

    <style include="prendus-styles">

      :host {
        display: block;
        padding: 10px;
      }

      .quiz-row {
				display: flex;
				align-items: center;
        padding: 10px;
        cursor: pointer;
      }

			.quiz-row + .quiz-row {
				border-top: solid lightgrey 1px;
			}

			.quiz-blankslate {
				padding: 10px;
			}

			.quiz-title {
				/* keeps text from overflowing a flexbox container */
				min-width: 0;
				flex-grow: 1;
			}

			.quiz-icons {
				flex-shrink: 0;
			}

			@media (max-width: 500px) {

				.quiz-row {
					flex-direction: column;
					align-items: flex-start;
				}

			}

    </style>

    <redux-store on-statechange="mapStateToThis" action="[[action]]"></redux-store>

    <template is="dom-repeat" items="[[quizzes]]" as="quiz">
      <div class="quiz-row" on-tap="viewQuiz">
				<span class="quiz-title">[[quiz.title]]</span>
				<div class="quiz-icons">
					<template is="dom-if" if="[[quiz.hasEditAccess]]">
						<paper-icon-button id="edit-quiz[[quiz.id]]" class="prendus-icon-button" icon="create" on-tap="editQuiz"></paper-icon-button>
						<paper-tooltip for="edit-quiz[[quiz.id]]" offset="0" animation-delay="300">Edit Quiz</paper-tooltip>
						<paper-icon-button id="delete-quiz[[quiz.id]]" class="prendus-icon-button" icon="delete" on-tap="openDeleteModal" delete="[[quiz.id]]"></paper-icon-button>
						<paper-tooltip for="delete-quiz[[quiz.id]]" offset="0" animation-delay="300">Delete Quiz</paper-tooltip>
					</template>
				</div>
      </div>
    </template>

    <h4 class="quiz-blankslate" hidden$="[[hasQuizzes(quizzes)]]">This concept doesn't have any quizzes yet.</h4>
    <template is="dom-if" if="[[courseEditAccess]]">
      <button class="prendus-button prendus-button--recommended" on-tap="addQuiz"><iron-icon icon="add"></iron-icon>Add quiz</button>
    </template>

    <paper-dialog id="confirm-delete-modal" with-backdrop>
      <h2>Confirm Delete</h2>
      <p>Are you sure you want to delete this quiz?  If you delete it, collaborators will lose access.</p>
      <div class="buttons">
        <button class="prendus-button prendus-button--minor" dialog-dismiss>Cancel</button>
        <button class="prendus-button prendus-button--destructive" on-tap="deleteQuiz">Delete</button>
      </div>
    </paper-dialog>

    <prendus-notification error-message="[[errorMessage]]" success-message="[[successMessage]]"></prendus-notification>
  </template>

  <script src="prendus-concept-quiz-container.ts"></script>
</dom-module>
