<link href="../../bower_components/polymer/polymer.html" rel="import">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/iron-dropdown/iron-dropdown.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../node_modules/prendus-services/styles/prendus-styles.html">

<dom-module id="prendus-navbar">

  <style include="prendus-styles">

		.navbar-text {
			color: white;
		}

		a:hover {
			text-decoration: none;
		}

		a, a:visited {
			color: currentColor;
		}

    paper-item:hover {
      background-color: var(--paper-grey-300);
    }

		#logo {
			height: 50px;
		}

    #home-link {
      margin-right: auto;
    }

    #menu-name-button {
      cursor: pointer;
			user-select: none;
    }

		#menu-icon-button {
			cursor: pointer;
			display: none;
		}

    #menu-holder {
      align-self: flex-end;
			color: initial;
    }

		#user-menu-listbox {
			min-width: 200px;
		}

		.menu-item {
			cursor: pointer;
			user-select: none;
		}

		@media (max-width: 768px) {
			#menu-name-button {
				display: none;
			}
			#menu-icon-button {
				display: block;
			}
		}

  </style>

  <template>

    <redux-store on-statechange="mapStateToThis" action="[[action]]"></redux-store>
    <paper-header-panel>
        <paper-toolbar>
          <a id="home-link" href="/"><img id="logo" src="../../images/navbar-logo.png" alt="Prendus"></a>
          <template is="dom-if" if="[[username]]">
						<!-- NOTE: use on-up here in order to maintain menu functionality -->
            <button id="menu-name-button" class="prendus-button prendus-button--recommended navbar-text" on-keydown="toggleMenuWithKeyboard" on-up="toggleMenu">
              [[username]] <iron-icon icon="arrow-drop-down"></iron-icon>
            </button>
						<!-- NOTE: use on-up here in order to maintain menu functionality -->
						<iron-icon id="menu-icon-button" class="navbar-text" icon="menu" on-up="toggleMenu"></iron-icon>

            <div id="menu-holder">
              <iron-dropdown id="menu-items" horizontal-align="right" no-auto-focus allow-outside-scroll>
                <paper-card class="dropdown-content">
                  <paper-listbox id="user-menu-listbox" on-tap="toggleMenu">
                    <a class="menu-item" href="/profile"><paper-item>Your account</paper-item></a>
                    <a class="menu-item" href="/courses/home"><paper-item>Your courses</paper-item></a>
                    <paper-item class="menu-item" on-tap="logOutUser" tabindex="0">Log out</paper-item>
                  </paper-listbox>
                </paper-card>
              </iron-dropdown>
            </div>
          </template>
          <template is="dom-if" if="[[!username]]">
            <a class="prendus-button prendus-button--recommended navbar-text" href="/login">Log In</a>
            <a class="prendus-button prendus-button--recommended navbar-text" href="/signup">Sign Up</a>
          </template>
        </paper-toolbar>
    </paper-header-panel>
  </template>

  <script src="prendus-navbar.ts"></script>
</dom-module>
