<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../prendus-notification/prendus-notification.html">
<link rel="import" href="../../bower_components/prendus-styles/prendus-styles.html">

<dom-module id="prendus-learning-structure">

  <style include="prendus-styles">

		#columns {
			display: flex;
		}

		.column {
			flex-basis: 33%;
			display: flex;
			flex-direction: column;
		}

		.column + .column {
			border-left: solid lightgrey 1px;
		}

		.column > :not(.column-item) {
			margin: 5px;
		}

		.column-item {
			display: flex;
			background-color: white;
			width: 100%;
		}

		.column-item:hover {
			background-color: var(--prendus-grey);
		}

		.column-item[selected] {
			background-color: var(--prendus-primary-color);
		}

		.column-item[selected] * {
			color: white;
			--paper-input-container-input-color: white;
			--paper-input-container-color: lightgrey;
		}

		.column-input,
		.column-button {
			background: none;
			border: none;
			font-size: 1em;
			text-align: left;
			cursor: pointer;
			padding: 10px 15px;
			flex-grow: 1;
		}

		.column-button:focus {
			outline: none;
			font-weight: bold;
		}

  </style>

  <template>

    <prendus-notification success-message="[[successMessage]]" error-message="[[errorMessage]]"></prendus-notification>
    <redux-store on-statechange="mapStateToThis" action="[[action]]"></redux-store>

		<div id="container" class="prendus-card prendus-vertical-container">
			<h1>Learning Structure</h1>
			<div id="columns">
				<div id="disciplines" class="column">
					<h3>Disciplines</h3>
					<template is="dom-repeat" items="[[disciplines]]" as="discipline">
						<div id="discipline[[discipline.id]]" class="column-item">
							<button class="column-button" hidden$="[[editing(discipline.id, editingIds)]]" on-tap="changeItem">[[discipline.title]]</button>
							<paper-input class="column-input" hidden$="[[!editing(discipline.id, editingIds)]]" label="Discipline Name" value="{{discipline.title}}" maxlength="30"></paper-input>
							<paper-icon-button class="prendus-icon-button" icon="[[getEditIcon(discipline.id, editingIds)]]" on-tap="toggleEdit"></paper-icon-button>
							<paper-icon-button class="prendus-icon-button" icon="delete" on-tap="openDeleteDialog"></paper-icon-button>
						</div>
					</template>
					<div class="column-item">
						<button class="column-button" on-tap="addDiscipline"><iron-icon icon="add"></iron-icon>Add Discipline</button>
					</div>
				</div>
				<div id="subjects" class="column" >
					<h3>Subjects</h3>
					<template is="dom-repeat" items="[[subjects]]" as="subject">
						<div id="subject[[subject.id]]" class="column-item">
							<button class="column-button" hidden$="[[editing(subject.id, editingIds)]]" on-tap="changeItem">[[subject.title]]</button>
							<paper-input hidden$="[[!editing(subject.id, editingIds)]]" label="Subject Name" value="{{subject.title}}" maxlength="30"></paper-input>
							<paper-icon-button class="prendus-icon-button" icon="[[getEditIcon(subject.id, editingIds)]]" on-tap="toggleEdit"></paper-icon-button>
							<paper-icon-button class="prendus-icon-button" icon="delete" on-tap="openDeleteDialog"></paper-icon-button>
						</div>
					</template>
					<div class="column-item" hidden$="[[!subjects]]">
						<button class="column-button" on-tap="addSubject"><iron-icon icon="add"></iron-icon>Add Subject</button>
					</div>
				</div>
				<div id="concepts" class="column">
					<h3>Concepts</h3>
					<template is="dom-repeat" items="[[concepts]]" as="concept">
						<div id="concept[[concept.id]]" class="column-item">
							<button class="column-button" hidden$="[[editing(concept.id, editingIds)]]" on-tap="changeItem">[[concept.title]]</button>
							<paper-input hidden$="[[!editing(concept.id, editingIds)]]" label="Concept Name" value="{{concept.title}}" maxlength="30"></paper-input>
							<paper-icon-button class="prendus-icon-button" icon="[[getEditIcon(concept.id, editingIds)]]" on-tap="toggleEdit"></paper-icon-button>
							<paper-icon-button class="prendus-icon-button" icon="delete" on-tap="openDeleteDialog"></paper-icon-button>
						</div>
					</template>
					<div class="column-item" hidden$="[[!concepts]]">
						<button class="column-button" on-tap="addConcept"><iron-icon icon="add"></iron-icon>Add Concept</button>
					</div>
				</div>
			</div>
		</div>

		<paper-dialog id="delete-dialog" with-backdrop>
			<div class="content">
				<h2>Confirm Delete</h2>
				<p>Do you really want to delete the "[[itemName]]" [[itemType]]?</p>
			</div>
		  <div class="buttons">
		  	<button class="prendus-button" dialog-dismiss>Cancel</button>
		  	<button class="prendus-button prendus-button--destructive" on-tap="deleteItem" dialog-dismiss>Delete</button>
		  </div>
		</paper-dialog>

  </template>

  <script src="prendus-learning-structure.ts"></script>
</dom-module>
